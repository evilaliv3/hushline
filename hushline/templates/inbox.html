{% extends "base.html" %}

{% block title %}Inbox{% endblock %}

{% block content %}
  <h2>Inbox for {{ user.primary_username.display_name or user.primary_username.username }}</h2>

  <ul class="tab-list">
    {% for status in [None] + message_statuses %}
      {% if status %}
        {% set display_str = status.display_str %}
        {% set url = url_for('inbox', status=status.value) %}
      {% else %}
        {% set display_str = "All" %}
        {% set url = url_for('inbox') %}
      {% endif %}
      <li>
        <a href="{{ url }}" class="tab{% if status == status_filter %} active{% endif %}">{{ display_str }}</a>
      </li>
    {% endfor %}
  </ul>

  {% if messages %}
    {% for message in messages %}
      <article
        class="message encrypted"
        aria-label="Message with {{ message.username.display_name or message.username.username }}"
      >
        {% if user_has_aliases %}
          <p>To: @{{ message.username.username }}</p>
        {% endif %}
        <p>{{ message.created_at.date() }}</p>
        <p><a class="stretched-link" href="{{ url_for('message', id=message.id) }}">Go to message</a></p>
      </article>
    {% endfor %}
  {% else %}
    <div class="emptyState">
      <img
        class="empty"
        src="{{ url_for('static', filename='img/app/empty.png') }}"
        alt="Empty Inbox"
      />
      <h1>Nothing to see here...</h1>
      <p>No messages yet.</p>
    </div>
  {% endif %}
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/mailvelope.js') }}"></script>
  <script src="{{ url_for('static', filename='js/inbox.js') }}"></script>
{% endblock %}
